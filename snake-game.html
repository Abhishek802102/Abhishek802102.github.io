<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate Snake Game Pro Enhance playing Now Play Now</title>
<style>
html, body {
  margin:0; padding:0; width:100%; height:100%; overflow:hidden;
  font-family: Arial, sans-serif; background:#211; color:white;
  display:flex; flex-direction:column; align-items:center;
}
#scoreboard {
  width:100%; text-align:center; padding:10px; font-size:25px;
  background:#222; box-shadow:0 0 15px #0f0; z-index:2;
  transition: all 0.3s ease;
}
canvas {
  border-radius:15px; display:none; touch-action:none; margin-top:5px;
  box-shadow:0 0 30px #0f0; z-index:1;
  position:relative;
}
button {
  padding:20px 50px; font-size:20px; margin-top:260px; cursor:pointer;
  border-radius:10px; border:none; background-color:#0f0; color:black; font-weight:bold;
}
#gameOverScreen {
  position:absolute; top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.50); display:flex; flex-direction:column;
  justify-content:center; align-items:center; font-size:28px; color:#fff;
  z-index:10; display:none;
}
#gameOverScreen button {
  margin-top:20px; background:#0f0; color:#111; font-size:22px;
  padding:12px 25px;
}
</style>
</head>
<body>
<div id="scoreboard">Score: 0 | HighScore: 0</div>
<canvas id="game"></canvas>
<button id="startBtn">Start Game</button>
<div id="gameOverScreen">
  <div id="gameOverText">Game Over!</div>
  <button id="playAgainBtn">Play Again</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const startBtn = document.getElementById("startBtn");
const scoreboard = document.getElementById("scoreboard");
const gameOverScreen = document.getElementById("gameOverScreen");
const playAgainBtn = document.getElementById("playAgainBtn");

let width, height;
let box = 12; // smaller pixels
let snake = [];
let direction;
let food;
let foodTypes = ["red","yellow","cyan","magenta","orange"];
let currentFoodIndex = 0;
let score;
let highScore = localStorage.getItem("highScore") || 0;
let gameRunning = false;
let speed = 140;
let lastTime = 0;
let particles = [];
let comboNumbers = [];
let trailParticles = [];
let gradientHue = 0;
let combo = 0;
let shakeOffset = {x:0,y:0};

const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function playFoodSound(index){
  const osc = audioCtx.createOscillator();
  const gainNode = audioCtx.createGain();
  osc.connect(gainNode);
  gainNode.connect(audioCtx.destination);
  osc.type=["square","sawtooth","triangle","sine","square"][index%5];
  osc.frequency.setValueAtTime(300 + index*100 + combo*20, audioCtx.currentTime);
  gainNode.gain.setValueAtTime(0.25, audioCtx.currentTime);
  osc.start();
  osc.stop(audioCtx.currentTime + 0.15);
}

function playCrash(){
  const osc = audioCtx.createOscillator();
  const gainNode = audioCtx.createGain();
  osc.connect(gainNode);
  gainNode.connect(audioCtx.destination);
  osc.type="triangle";
  osc.frequency.setValueAtTime(120, audioCtx.currentTime);
  gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
  osc.start();
  osc.stop(audioCtx.currentTime + 0.3);
}

function resizeCanvas(){
  width = window.innerWidth;
  height = window.innerHeight - scoreboard.offsetHeight - 20;
  canvas.width = width;
  canvas.height = height;
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

function updateScore(){
  scoreboard.textContent = `Score: ${score} | HighScore: ${highScore}`;
  scoreboard.style.boxShadow = score > highScore ? "0 0 25px #ff0" : "0 0 15px #0f0";
}

function initGame(){
  snake = [{x:Math.floor(width/2/box)*box, y:Math.floor(height/2/box)*box}];
  direction = "RIGHT";
  score = 0; combo = 0; currentFoodIndex = 0;
  particles=[]; comboNumbers=[]; trailParticles=[];
  shakeOffset={x:0,y:0}; gameRunning=true; lastTime=0; gradientHue=0;
  spawnFood(); updateScore(); canvas.style.display="block";
  startBtn.style.display="none"; gameOverScreen.style.display="none";
  requestAnimationFrame(gameLoop);
}

function spawnFood(){
  let overlap;
  do{
    overlap=false;
    food = { x: Math.floor(Math.random()*(width/box))*box, y: Math.floor(Math.random()*(height/box))*box, color: foodTypes[currentFoodIndex] };
    snake.forEach(s=>{ if(s.x===food.x && s.y===food.y) overlap=true; });
  }while(overlap);
}

// Touch
let touchStartX=0,touchStartY=0;
canvas.addEventListener("touchstart", e=>{
  e.preventDefault();
  const touch = e.touches[0];
  touchStartX = touch.clientX; touchStartY = touch.clientY;
});
canvas.addEventListener("touchend", e=>{
  e.preventDefault();
  const touch = e.changedTouches[0];
  const dx = touch.clientX - touchStartX;
  const dy = touch.clientY - touchStartY;
  if(Math.abs(dx)>Math.abs(dy)){ if(dx>0 && direction!=="LEFT") direction="RIGHT"; if(dx<0 && direction!=="RIGHT") direction="LEFT"; } 
  else { if(dy>0 && direction!=="UP") direction="DOWN"; if(dy<0 && direction!=="DOWN") direction="UP"; }
});
document.addEventListener("keydown", e=>{
  if(e.key==="ArrowLeft" && direction!=="RIGHT") direction="LEFT";
  if(e.key==="ArrowRight" && direction!=="LEFT") direction="RIGHT";
  if(e.key==="ArrowUp" && direction!=="DOWN") direction="UP";
  if(e.key==="ArrowDown" && direction!=="UP") direction="DOWN";
});

function drawSnakeSegment(x,y,isHead=false){
  const gradient = ctx.createRadialGradient(x+box/2,y+box/2,1,x+box/2,y+box/2,box/2);
  gradient.addColorStop(0,isHead?"#0ff":"#0a8f00");
  gradient.addColorStop(1,"#030");
  ctx.fillStyle = gradient; ctx.fillRect(x,y,box,box);
  if(isHead){
    ctx.shadowColor="#0ff"; ctx.shadowBlur=15+Math.sin(Date.now()/100)*5;
  } else { ctx.shadowColor="#0f0"; ctx.shadowBlur=8; }
}

function collision(head){ return snake.some(s=> s.x===head.x && s.y===head.y); }

function createParticles(x,y,color){
  let colors = [color,"#0ff","#0cf","#08f","#0af"];
  for(let i=0;i<20;i++){ particles.push({x:x+box/2,y:y+box/2,vx:(Math.random()-0.5)*3,vy:(Math.random()-0.5)*3,alpha:1,color:colors[Math.floor(Math.random()*colors.length)],size: Math.random()*3+2}); }
  if(combo>1){ comboNumbers.push({x:x,y:y,value:combo,alpha:1}); }
}

function createTrail(x,y){
  trailParticles.push({x:x+box/2,y:y+box/2,alpha:0.6,size: box,color:`hsl(${gradientHue},100%,50%)`});
}

function drawParticles(){
  particles.forEach((p,i)=>{
    ctx.fillStyle="rgba("+hexToRgb(p.color)+","+p.alpha+")";
    ctx.shadowColor=p.color; ctx.shadowBlur=8; ctx.beginPath(); ctx.arc(p.x,p.y,p.size,0,Math.PI*2); ctx.fill();
    p.x+=p.vx; p.y+=p.vy; p.alpha-=0.03; p.size*=0.95; if(p.alpha<=0) particles.splice(i,1);
  });
  comboNumbers.forEach((c,i)=>{
    ctx.fillStyle=`rgba(255,255,0,${c.alpha})`; ctx.font="16px Arial";
    ctx.fillText("Combo x"+c.value,c.x,c.y); c.y-=0.5; c.alpha-=0.02; if(c.alpha<=0) comboNumbers.splice(i,1);
  });
  trailParticles.forEach((t,i)=>{
    ctx.fillStyle=`rgba(${hexToRgb(t.color)},${t.alpha})`;
    ctx.beginPath(); ctx.arc(t.x,t.y,t.size/2,0,Math.PI*2); ctx.fill();
    t.alpha-=0.02; if(t.alpha<=0) trailParticles.splice(i,1);
  });
}

function hexToRgb(hex){hex=hex.replace("#",""); const bigint=parseInt(hex,16); return ((bigint>>16)&255)+"," + ((bigint>>8)&255)+"," + (bigint&255);}

function drawFood(){
  ctx.fillStyle = food.color; ctx.beginPath(); ctx.arc(food.x+box/2, food.y+box/2, box/2,0,Math.PI*2); ctx.fill();
  ctx.shadowBlur=12; ctx.shadowColor=food.color;
}

function drawBackground(){ gradientHue+=0.3; let grad = ctx.createLinearGradient(0,0,width,height);
grad.addColorStop(0, `hsl(${gradientHue},50%,10%)`); grad.addColorStop(1, `hsl(${(gradientHue+60)%360},60%,15%)`); ctx.fillStyle=grad; ctx.fillRect(0,0,width,height); }

function showGameOver(){ gameOverScreen.style.display="flex"; canvas.style.display="none"; }

function gameLoop(timestamp){
  if(!gameRunning) return;
  if(timestamp - lastTime < speed){ requestAnimationFrame(gameLoop); return; }
  lastTime = timestamp;

  ctx.save(); ctx.translate(shakeOffset.x,shakeOffset.y);

  drawBackground(); drawFood(); drawParticles();

  let headX = snake[0].x; let headY = snake[0].y;
  if(direction==="LEFT") headX-=box; if(direction==="RIGHT") headX+=box;
  if(direction==="UP") headY-=box; if(direction==="DOWN") headY+=box;

  let hitWall = headX<0 || headX>=width || headY<0 || headY>=height;
  const newHead = {x:headX,y:headY};

  if(hitWall || collision(newHead)){
    shakeOffset.x = (Math.random()-0.5)*15; shakeOffset.y = (Math.random()-0.5)*15;
    playCrash(); gameRunning=false;
    if(score>highScore){ highScore=score; localStorage.setItem("highScore",highScore);}
    updateScore(); showGameOver(); ctx.restore(); return;
  } else { shakeOffset.x=0; shakeOffset.y=0; }

  if(headX===food.x && headY===food.y){
    score++; combo++; createParticles(food.x,food.y,food.color); playFoodSound(currentFoodIndex);
    if(combo>=3){ for(let i=0;i<50;i++) createParticles(food.x,food.y,"#fff"); } // super combo explosion
    currentFoodIndex = (currentFoodIndex+1) % foodTypes.length; spawnFood(); updateScore();
  } else { snake.pop(); combo=0; }

  snake.unshift(newHead);
  snake.forEach((s,i)=>{ drawSnakeSegment(s.x,s.y,i===0); createTrail(s.x,s.y); });

  ctx.restore();
  requestAnimationFrame(gameLoop);
}

startBtn.addEventListener("click", initGame);
playAgainBtn.addEventListener("click", initGame);
</script>
</body>
</html>